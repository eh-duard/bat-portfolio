---
import DualContent from './DualContent.astro';

const projects = [
  { 
    title: 'E-Commerce Platform', 
    desc: 'Full stack online store with Stripe payment integration.',
    tech: ['Next.js', 'Stripe', 'PostgreSQL'],
    caseFile: 'FILE #892: "THE MARKETPLACE"',
    codeSnippet: `const checkout = await stripe.paymentIntents.create({
  amount: cart.total,
  currency: 'usd',
  automatic_payment_methods: { enabled: true },
});`
  },
  { 
    title: 'Task Management App', 
    desc: 'Real-time collaboration tool for remote teams.',
    tech: ['React', 'Firebase', 'Tailwind'],
    caseFile: 'FILE #104: "OPERATION SYNC"',
    codeSnippet: `useEffect(() => {
  const unsubscribe = onSnapshot(doc(db, "tasks"), (doc) => {
    setTasks(doc.data().items);
  });
  return () => unsubscribe();
}, []);`
  },
  { 
    title: 'AI Image Generator', 
    desc: 'SaaS application using Stable Diffusion API.',
    tech: ['SvelteKit', 'Python', 'FastAPI'],
    caseFile: 'FILE #771: "SYNTHETIC VISIONS"',
    codeSnippet: `def generate_image(prompt: str):
    image = pipeline(prompt).images[0]
    return {"url": upload_to_s3(image)}`
  }
];
---

<section id="projects" class="py-32 px-4 w-full relative on-scroll">
  <div class="container mx-auto max-w-7xl">
    
    <DualContent>
      <!-- DEV MODE CONTENT -->
      <div slot="dev">
        <div class="text-center mb-16">
            <h2 class="text-xs font-bold tracking-[0.2em] text-gray-500 uppercase mb-4" data-i18n="mission.label">Selected Work</h2>
            <h2 class="text-4xl md:text-5xl font-bold tracking-tight mb-4" data-i18n="mission.title">Featured Projects</h2>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {projects.map(project => (
                <div class="group bg-[#0a0a0a] rounded-3xl overflow-hidden border border-white/5 hover:border-white/10 transition-all duration-500 hover:shadow-2xl hover:shadow-purple-900/10 flex flex-col h-full">
                    
                    <!-- Code Snippet Header / Preview -->
                    <div class="relative bg-[#111] p-6 border-b border-white/5 min-h-[200px] flex flex-col font-mono text-xs">
                        <div class="flex gap-2 mb-4">
                            <div class="w-3 h-3 rounded-full bg-red-500/20 text-red-500 flex items-center justify-center"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500/20 text-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500/20 text-green-500"></div>
                        </div>
                        <div class="text-gray-500 select-none mb-2"> // {project.title} Logic </div>
                        <pre class="text-gray-300 overflow-x-auto custom-scrollbar flex-1"><code class="language-js">{project.codeSnippet}</code></pre>
                        
                        <!-- Gradient Overlay -->
                        <div class="absolute inset-0 bg-gradient-to-t from-[#111] to-transparent opacity-50"></div>
                    </div>

                    <div class="p-8 flex flex-col flex-1 space-y-4">
                        <div>
                            <h3 class="text-xl font-bold text-white mb-2 group-hover:text-purple-400 transition-colors">{project.title}</h3>
                            <p class="text-gray-400 text-sm leading-relaxed">{project.desc}</p>
                        </div>
                        
                        <div class="flex-1"></div> <!-- Spacer -->

                        <div class="flex flex-wrap gap-2 pt-4 border-t border-white/5">
                            {project.tech.map(t => (
                                <span class="px-3 py-1 text-[10px] uppercase tracking-wider font-medium bg-white/5 text-gray-400 rounded-full border border-white/5 group-hover:border-white/20 transition-colors">{t}</span>
                            ))}
                        </div>
                    </div>
                </div>
            ))}
        </div>
      </div>

      <!-- BATMAN MODE CONTENT -->
      <div slot="batman">
        <h2 class="text-4xl md:text-5xl font-display text-center text-[#ffd700] mb-20 tracking-widest drop-shadow-[0_0_15px_rgba(255,215,0,0.5)]" data-i18n="mission.batTitle">ARCHIVED CASE FILES</h2>
        
        <div class="space-y-12 max-w-5xl mx-auto">
            {projects.map((project, index) => (
                <div class="relative pl-8 md:pl-12 border-l-2 border-[#333] hover:border-[#ffd700] transition-colors duration-500 py-2 group">
                    <!-- Timeline Node -->
                    <div class="absolute -left-[9px] top-0 w-4 h-4 bg-[#0a0a0a] border-2 border-[#333] group-hover:border-[#ffd700] group-hover:bg-[#ffd700] transition-all duration-500 rotate-45"></div>
                    
                    <div class="bg-[#0c0c0c] border border-[#222] p-8 relative overflow-hidden group-hover:border-[#ffd700]/30 transition-all">
                        <!-- Holographic Grid -->
                        <div class="absolute inset-0 bg-[url('/bat-portfolio/grid.svg')] opacity-5 pointer-events-none"></div>

                        <div class="flex flex-col md:flex-row gap-8 relative z-10">
                            <!-- File Meta -->
                            <div class="flex-1 space-y-4">
                                <div class="flex items-center gap-4 text-[#b8860b] font-mono text-xs">
                                    <span class="border border-[#b8860b] px-2 py-0.5" data-i18n="mission.topSecret">TOP SECRET</span>
                                    <span data-i18n="mission.sector">// SECTOR 7G</span>
                                </div>
                                
                                <h3 class="text-3xl font-display text-gray-200 group-hover:text-white transition-colors tracking-wide">{project.caseFile}</h3>
                                
                                <p class="text-[#888] font-mono text-sm leading-7">
                                    <span class="text-[#ffd700]">></span> <span data-i18n="mission.subject">SUBJECT:</span> {project.title}<br/>
                                    <span class="text-[#ffd700]">></span> <span data-i18n="mission.analysis">ANALYSIS:</span> {project.desc}<br/>
                                    <span class="text-[#ffd700]">></span> <span data-i18n="mission.status">STATUS: DECLASSIFIED</span>
                                </p>
                            </div>
                            
                            <!-- Action Panel -->
                            <div class="w-full md:w-48 flex flex-col justify-start gap-4 border-l border-[#222] pl-0 md:pl-8">
                                <div class="flex flex-wrap gap-2 content-start">
                                    {project.tech.map(t => (
                                        <span class="text-[9px] font-mono text-[#444] group-hover:text-[#ffd700] block w-full text-right">{t} :: </span>
                                    ))}
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
      </div>
    </DualContent>

  </div>
</section>

<style>
    .custom-scrollbar::-webkit-scrollbar { height: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; }
</style>
